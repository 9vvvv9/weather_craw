import get_7d_weather
import get_24h_weather
import get_curr_weather
import get_diff_weather
from get_user_agent import get_user_agent
import pymysql  # 导入MySQL驱动
import schedule
import time


conn=pymysql.connect(host='localhost',user='root',passwd='root',db='weather',port=3306,charset='utf8')  #连接数据库
cursor=conn.cursor()   # 使用cursor()方法获取操作游标

city_ids = ['101270101',
'101270102',
'101270103',
'101270104',
'101270105',
'101270106',
'101270107',
'101270108',
'101270109',
'101270110',
'101270111',
'101270112',
'101270113',
'101270114',
'101270115',
'101270116',
'101270117',
'101270118',
'101270119',
'101270120',
'101270121',
'101270201',
'101270202',
'101270203',
'101270204',
'101270205',
'101270206',
'101270301',
'101270302',
'101270303',
'101270304',
'101270305',
'101270306',
'101270307',
'101270401',
'101270402',
'101270403',
'101270405',
'101270406',
'101270407',
'101270408',
'101270409',
'101270410',
'101270411',
'101270501',
'101270502',
'101270503',
'101270504',
'101270505',
'101270506',
'101270507',
'101270508',
'101270509',
'101270510',
'101270601',
'101270602',
'101270603',
'101270604',
'101270605',
'101270606',
'101270607',
'101270608',
'101270701',
'101270702',
'101270703',
'101270704',
'101270705',
'101270706',
'101270801',
'101270802',
'101270803',
'101270804',
'101270805',
'101270806',
'101270901',
'101270902',
'101270903',
'101270904',
'101270905',
'101270906',
'101271001',
'101271002',
'101271003',
'101271004',
'101271005',
'101271006',
'101271007',
'101271008',
'101271101',
'101271102',
'101271103',
'101271104',
'101271105',
'101271106',
'101271107',
'101271108',
'101271109',
'101271110',
'101271111',
'101271201',
'101271202',
'101271203',
'101271204',
'101271205',
'101271206',
'101271301',
'101271302',
'101271303',
'101271305',
'101271401',
'101271402',
'101271403',
'101271404',
'101271405',
'101271406',
'101271407',
'101271409',
'101271410',
'101271411',
'101271412',
'101271413',
'101271414',
'101271501',
'101271502',
'101271503',
'101271504',
'101271505',
'101271506',
'101271507',
'101271601',
'101271603',
'101271604',
'101271605',
'101271606',
'101271607',
'101271608',
'101271609',
'101271610',
'101271611',
'101271612',
'101271613',
'101271614',
'101271615',
'101271616',
'101271617',
'101271618',
'101271619',
'101271701',
'101271702',
'101271703',
'101271704',
'101271705',
'101271706',
'101271707',
'101271708',
'101271709',
'101271801',
'101271802',
'101271803',
'101271804',
'101271805',
'101271806',
'101271807',
'101271808',
'101271809',
'101271810',
'101271811',
'101271812',
'101271813',
'101271814',
'101271815',
'101271816',
'101271817',
'101271818',
'101271901',
'101271902',
'101271903',
'101271904',
'101271905',
'101271906',
'101271907',
'101271908',
'101271909',
'101271910',
'101271911',
'101271912',
'101271913',
'101272001',
'101272002',
'101272003',
'101272004',
'101272005',
'101272006',
'101272007',
'101272101',
'101272102',
'101272103',
'101272104',
'101272105',
'101272106',
'101272107',
'101272108']

def get_cuur():
    for city_id in city_ids:
        get_curr_weather.get_currtem(city_id,cursor,user_agent)

def get_24h():
    for city_id in city_ids:
        get_24h_weather.get_weather(city_id,cursor,user_agent)

def get_7d():
    for city_id in city_ids:
        get_7d_weather.get_weather(city_id,cursor,user_agent)

def get_diff():
    get_diff_weather.get_temperature(cursor,user_agent)

if __name__=='__main__':
    user_agent = get_user_agent()
    #get_diff_weather.get_temperature(cursor,user_agent)
    #schedule.every().day.at("21:57").do(get_diff)
    # schedule.every(30).minutes.do(get_cuur)
    # schedule.every(24).hours.do(get_24h)
    # schedule.every(7).days.do(get_7d)
        
    # while True:
    #     schedule.run_pending()
    #     time.sleep(1)

    for city_id in city_ids:
        get_curr_weather.get_currtem(city_id,cursor,user_agent)
    #    get_24h_weather.get_weather(city_id,cursor,user_agent)
    #    get_7d_weather.get_weather(city_id,cursor,user_agent)

conn.commit()  # 提交事务    
cursor.close()  # 关闭光标对象
conn.close()  #关闭数据库连接
